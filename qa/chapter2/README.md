# 모바일 서비스 테스트 자동화

테스트 자동화 : 소프트웨어를 활용해 사람의 개입을 최소화하고 환경설정, 테스트 실행과 제어, 테스트 보고서 작성 등에 이르는 테스트 과정이 자동으로 이뤄지게 하는것.

일관되고 반복가능한 테스트 프로세스를 적용해 회귀 테스트 등을 자동화하면 짧은 시간 동안 더 많은 테스트를 실행할 수 있고 간단한 결함은 쉽게 재현할 수 있다.

## 자동화를 위한 구성요소 식별 방법

자동화도구는 구성 요소를 식별해 원하는 요소를 클릭하거나 해당 요소가 있는지 확인한다. 식별 방법은 이미지 방식과 오브젝트 방식이 있다.

- 이미지 방식 : 이미지를 이용해 화면에 동일한 이미지를 찾아 테스트를 수행, 실제 모바일 기기를 연결하거나 에뮬레이터를 실행해서 PC에 모바일 화면이 보이게 설정해야함.
- 오브젝트 방식 : 버튼이나 입력상자 등의 구성요소에 부여된 아이디, 텍스트 등의 속성으로, 요소를 찾아 테스트를 수행

유지보수측면에서 오브젝트 방식을 권장하지만, 오브젝트 방식으로 자동화 할 수 없는 부분에는 이미지 방식을 사용해야함.

## 테스트 자동화 프레임워크

UI Automator
Espresso
monkeyrunner
Selendroid
Calabash

### 안드로이드 테스트 자동화 프레임워크

![KakaoTalk_Photo_2019-06-23-16-16-16](https://user-images.githubusercontent.com/20614643/59972900-454f3380-95d2-11e9-9578-77319bd017ec.jpeg)

### 크로스 플랫폼 자동화 도구

![KakaoTalk_Photo_2019-06-23-16-16-21](https://user-images.githubusercontent.com/20614643/59972899-44b69d00-95d2-11e9-8c16-cc29fee60edb.jpeg)

대부분의 상용 도구는 다양한 플랫폼을 지원하지만, 돈이 든다는 것이 단점이다.

## 오픈 소스 도구를 활용한 테스트 자동화

대표적인 오픈소스 도구는 Sikuli, UI Automator, Robotium, Appium 등이 있고 윈도우와 맥에서 모두 지원한다.
테스트 자동화 도구를 사용하기 전에 공통으로 설정해하 하는 환경은 다음과 같다.

- 안드로디으 SDK 설치
- 테스트 기기 준비/설정
- .apk 파일 준비
- 테스트 시나리오 준비

### 테스트 시나리오

모바일 앱을 테스트할 때 자주 사용하는 클릭, 문자 입력, 스크롤 동작 등을 확인함. 아래의 시나리오는 네이버 뮤직 앱을 예제로 사용했다.

1. 네이버 뮤직 앱을 실행하고 실행여부를 확인한다. '국내 TOP 100'과 '국내 최신앨범'이 표시되면 올바르게 실행된 것으로 판단한다.
2. 검색 창에 검색어를 입력하고 검색 결과를 확인한다. 검색어로는 '2ne1'을 입력하고, 검색 결과에 'Come Back Home'이 표시되면 결과가 올바르게 나온 것으로 판단한다.
3. 검색 결과 화면을 스크롤해 화면에 표시되는 곡을 확인한다. 'I Love You'가 표시되면 스크롤된 것으로 판단한다.


## 테스트 툴/프레임워크

### Sikuli

- openVC를 사용하여 GUI를 컨트롤 할수 있음
- 화면을 보여주는 보어의 이미지 품질에 따라 이미지를 찾지 못하는 경우도 있음
- 이미지를 갈무리 하여 테스트 시나리오를 작성한다
- 예외 발생시 로그가 출력되며 테스트 중단
- 실효성이 있을지는 논의 필요

### UI Automator

- UI 테스트 도구, UI Automator를 제공.
- UI를 스캔해 분석하는 GUI 도구.
- 안드로이드 스튜디오 SDK에서 설치
- Sikuli와 동일한 프로세스로 테스트 스크립트를 만들지만, 이미지가 아닌 오브젝트를 사용
- 오브젝트의 판별은 text 등으로 한다.

### Appium

- 클라이언트와 서버로 나뉜 테스트 환경을 구축 가능
- 클라이언트에서 안드로이드 os와 디바이스, 타겟 앱에 대한 패키지 이름 설정 후 테스트 코드 실행
- 테스트 코드는 UI Automator와 동일

### 테스트 툴/프레임워크의 장단점

- 이미지 방식 도구는 쉽게 구현이 가능하나 유지보수가 어렵다.
- 오브젝트 방식은 구현이 어려우나 유지보수가 대체로 쉽다.

## 웹쿠리

### 장점

- 네이버에서 제작
- 자동화 환경 간편 구성
- 프로그래밍 언어에 익숙하지 않은 테스터도 스크립트 쉽게 작성 가능
- 사용자 행동에 초점을 맞춤
- 스크립트 가독성이 높음
- UI 테스트 지만 유지 보수가 쉽다.
- 안드로이드 기기 루팅 불필요
- .apk 파일 수정하지 않음
- 한글 입력가능
- 여러 모바일 기기에서 동시 테스트 가능

### 특징

- 액션 키워드 사용
- 오브젝트 방식 요소 식별
- 리소스 키워드 사용
- 프런트 엔드 성능 측정
- 다중 기기 제어